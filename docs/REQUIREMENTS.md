# Helpdesk Commander 要件定義

## 1. 背景・目的
Helpdesk Commander は、社内の「タスク管理」と「ヘルプデスク（問い合わせ/チケット）」を統合し、品質に関わる全員が状況を共有しながら、迅速に一次対応〜解決〜検証〜承認までを完結できるようにする。

本要件定義では、従来の問い合わせ受付/チケット管理に加えて、個別不具合・性能劣化・ミッションクリティカルな障害を含む「障害管理（Incident Management）」を段階的に導入するための要件を定義する。

## 2. スコープ
### 2.1 対象（スコープ内）
- Webフォームからの問い合わせ受付
- 問い合わせからのチケット自動生成
- チケットの状態管理、担当、優先度、SLAの運用
- チケット解決後の「品質確認（検証）」と「最終承認」
- 障害（Incident）への昇格/降格、およびタイムライン管理（段階導入）
- ダッシュボード/レポート（段階導入）

### 2.2 非対象（当面スコープ外）
- 初期段階での監視連携（将来対応）
- チャット連携（将来対応）
- SSO（将来対応）

## 3. 利用者・ロール
### 3.1 基本方針
- 利用者はサポート担当に限定しない。品質に関わる人間は全員が操作できる。
- ただし、以下は管理者またはリーダーのみが実行できる。
  - 優先度の設定・変更
  - 対応完了後の検証作業の最終承認（Verified/Closed への遷移）
  - Incident の宣言（昇格）/解除（降格）

### 3.2 ロール案（初期）
- 一般ユーザー（Requester/Verifier）
  - 問い合わせの作成
  - チケットの閲覧（権限設計に従う）
  - コメント/追加情報提供
  - 検証（品質確認）の実施・結果入力
- エージェント（Agent）
  - チケット対応、状態更新、担当作業
  - 検証依頼の実施（依頼者/第三者への依頼）
- リーダー/管理者（Leader/Admin）
  - 優先度管理
  - Incident 運用（宣言/解除、SEV設定）
  - 検証結果の承認、クローズ

## 4. 概念モデル（用語・エンティティ）
### 4.1 問い合わせ（Inquiry）
- Webフォームから投稿される入力。
- 投稿後にチケットを自動生成する。

### 4.2 チケット（Ticket）
- 運用の基本単位。問い合わせ・困りごと・質問・不具合・障害候補を統一的に扱う。
- チケットの種別（type）により運用を分岐する。

チケット種別（例）
- question（質問）
- request（依頼）
- bug（個別不具合）
- incident_candidate（障害候補）

### 4.3 障害（Incident）
- サービス影響が大きい事象を扱う「障害管理」用の追加レイヤ。
- Ticket から Incident に昇格して運用する。
- Incident はタイムライン（いつ、何が起き、どう対応し、どう復旧したか）を持つ。

### 4.4 検証（Verification）
- チケットの「対応完了（resolved）」後に実施する品質確認。
- 検証者は一般ユーザー（依頼者）でも可能。
- ただし、最終承認（verified/closed）はリーダー/管理者のみ。

### 4.5 イベントログ（Audit/Event Log）
- 状態変更、担当変更、優先度変更、コメント等の主要操作はイベントとして記録する。
- 監査・ふりかえり・Incidentタイムラインの基盤となる。

## 5. 機能要件
### 5.1 受付（Webフォーム）
- Webフォームから問い合わせを作成できる。
- 送信時に最低限の入力（件名/本文/連絡先等）をバリデーションする。
- 送信後に Ticket を自動生成する。

### 5.2 チケット管理
- チケット一覧：状態、担当、優先度、種別でフィルタ/ソートできる。
- チケット詳細：本文、履歴（イベントログ）、コメント、担当、優先度、SLA情報を表示できる。
- チケット状態管理：定義されたステータスに従って遷移できる。

推奨ステータス（初期）
- new（受付直後）
- triage（切り分け/情報収集）
- in_progress（対応中）
- waiting（依頼者/他チーム待ち）
- resolved（対応完了）
- verified（検証・承認済）
- closed（クローズ）

### 5.3 検証・承認フロー
- resolved になったチケットは検証フェーズに入る。
- 一般ユーザー（依頼者を含む）は、検証結果を入力できる。
  - 例：再現確認、期待動作確認、手順、結果、確認日時、確認者
- リーダー/管理者のみが、検証結果を確認し最終承認して verified/closed に遷移できる。
- 承認時の承認者・承認日時を記録する。

### 5.4 優先度（Priority）とSLA
- 優先度は Impact（影響）× Urgency（緊急度）から算出する設計を推奨する。
- 優先度の最終確定・変更はリーダー/管理者のみが行える。
- SLAは優先度に紐づく目標時間（一次応答/暫定対応/解決/復旧など）として定義し、監視・可視化する（段階導入）。

優先度（例）
- P1（緊急）
- P2（高）
- P3（中）
- P4（低）

### 5.5 障害管理（Incident）
- 障害とする範囲：個別不具合、性能劣化、ミッションクリティカルな障害を含む。
- チケットから Incident に昇格できる（リーダー/管理者のみ）。
- Incident では以下を扱える。
  - SEV（重大度）
  - 影響範囲
  - タイムライン（調査/暫定対応/復旧/監視/振り返り）
  - 周知用メモ（将来、チャット/ステータスページに展開可能）

### 5.6 タスク管理（README計画に準拠）
- タスクのCRUD
- ステータス（未着手/進行中/完了）
- 優先度（低/中/高）
- 期限
- 担当者

### 5.7 共通
- ユーザー管理
- ダッシュボード（段階導入）
- レポート（段階導入）
- リアルタイム更新（LiveView）

## 6. 非機能要件
- 監査性：重要操作はイベントとして追跡可能であること。
- セキュリティ：権限（ロール）により、優先度変更/承認/Incident宣言が制限されること。
- 運用性：チケットとIncidentが同じ体験で追跡でき、将来の連携（監視/チャット/SSO）を阻害しないこと。
- 拡張性：チケット種別やSLAルールの追加・変更が可能であること。

## 7. 段階導入（ロードマップの要件化）
- フェーズ1（MVP）：Webフォーム→Inquiry→Ticket、一覧/詳細、状態更新、イベントログ
- フェーズ2：認証/権限、優先度管理（リーダー限定）、検証・承認フロー
- フェーズ3：Incident昇格/降格、SEV、タイムライン
- フェーズ4：コメント/添付/通知
- フェーズ5：SLA監視/統計/レポート
- フェーズ6：監視/チャット/SSO連携

## 8. 将来拡張・独自性の高い機能案
- 類似チケット提案（重複検知/既知事象の提示）
- 影響範囲マップ（簡易サービスカタログ）
- 変更相関（デプロイ/PR/DB変更との相関）による原因推定支援
